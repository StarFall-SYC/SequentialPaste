# 顺序粘贴工具(Sequential Paste Tool)

一个功能强大、界面美观的跨平台顺序粘贴工具。专为需要重复填写序列数据的场景设计，支持悬浮窗、全局快捷键、拖拽导入等功能。

>注意：当前项目尚未进行在Mac和Linux上进行测试，如有问题请详细报告

## ✨ 核心功能

*   **📋 顺序粘贴**：按 `Ctrl+V` 依次粘贴列表中的每一项内容，自动流转。
*   **🔙 智能回退**：支持快捷键 `Alt+Ctrl+V` 回退到上一项，防止误操作。
*   **🖥️ 智能悬浮窗**：
    *   **实时预览**：显示当前粘贴内容及下一项预览。
    *   **自动隐藏**：拖至屏幕边缘自动收起，鼠标靠近即可灵敏唤出。
    *   **位置锁定**：提供锁定按钮，防止误触拖动。
    *   **迷你控制**：悬浮窗内置 上一条/重置/下一项/锁定 控制按钮。
*   **🖱️ 极速导入**：支持直接将 `.txt` 文件拖入主界面进行导入。
*   **🕶️ 后台运行**：支持最小化到系统托盘，不占用任务栏空间。
*   **🚀 开机自启**：内置开机自启配置（支持 Windows/macOS/Linux）。
*   **💾 数据持久化**：自动记忆上次的文件、进度及悬浮窗位置，重启无忧。
*   **🖥️ 多屏支持**：完美适配多显示器环境，悬浮窗随处可栖。

## ⌨️ 快捷键说明

| 功能 | Windows / Linux | macOS | 说明 |
| :--- | :--- | :--- | :--- |
| **粘贴下一项** | `Ctrl + V` | `Cmd + V` | 粘贴当前内容，并自动准备下一条 |
| **回退上一项** | `Alt + Ctrl + V` | `Option + Cmd + V` | 仅回退进度，不触发粘贴操作 |
| **普通粘贴** | `Shift + Ctrl + V` | `Shift + Cmd + V` | 保持系统默认行为（纯文本粘贴） |

> **注意**：程序会智能拦截 `Ctrl+V`。只有当列表中有内容且未结束时，才会接管粘贴行为；否则保持系统原生粘贴功能。

## 🛡️ 权限说明

为了确保全局快捷键（如 `Ctrl+V`）在所有应用程序中都能稳定生效，本软件对运行权限有一定建议：

### Windows
*   **建议权限**：**以管理员身份运行**。
*   **原因**：Windows 安全机制规定，低权限程序无法拦截或监听高权限程序（如任务管理器、以管理员运行的游戏或CMD）的键盘输入。
*   **如果不给管理员权限**：
    *   软件**可以正常启动**和运行。
    *   在普通软件（如记事本、浏览器）中，快捷键功能正常。
    *   但在**以管理员身份运行的目标窗口**中，`Ctrl+V` 等快捷键将**失效**（无法触发本软件的粘贴逻辑）。
    *   *注：软件会在主界面状态栏提示当前权限状态。*

### macOS
*   **必要权限**：**辅助功能 (Accessibility)**。
*   **设置方法**：系统偏好设置 -> 安全性与隐私 -> 隐私 -> 辅助功能 -> 勾选本程序（或 Terminal/Python）。
*   **如果不给权限**：
    *   `pynput` 库无法监听键盘事件，导致快捷键**完全失效**。
    *   软件只能通过点击悬浮窗按钮或主界面按钮进行操作。

### Linux
*   **依赖**：通常需要 X11 环境或正确的输入设备组权限（如 `input` 组）。
*   **如果不给权限**：快捷键可能无法在其他窗口全局生效。

## 📦 安装与运行

### 1. 环境要求
*   Python 3.6+
*   依赖库：`PyQt6`, `pynput`, `pyperclip`

### 2. 安装依赖
```bash
pip install PyQt6 pynput pyperclip
```

### 3. 运行程序
```bash
python sequential_paste.py
```

## 📖 使用指南

1.  **导入数据**：
    *   点击“📂 导入文件”按钮选择文本文件。
    *   或者直接将 `.txt` 文件拖入程序主窗口。
    *   *数据格式：每行一条内容。*
2.  **开始工作**：
    *   切换到目标软件（如 Excel、浏览器）。
    *   按 `Ctrl+V` 粘贴第一项，再次按下粘贴第二项，以此类推。
3.  **悬浮窗操作**：
    *   点击“🖥️ 开启悬浮窗”按钮。
    *   悬浮窗会显示当前进度。双击列表项可快速跳转。
    *   将悬浮窗拖到屏幕边缘可自动隐藏，鼠标靠近边缘即可唤出。
4.  **后台模式**：
    *   点击“🕶️ 后台运行”或直接关闭窗口，程序将缩在系统托盘运行。
    *   双击托盘图标可恢复主界面。

---
*Developed by XINGLUO*